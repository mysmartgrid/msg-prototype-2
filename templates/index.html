{{define "index"}}
{{template "head" "home"}}
<div class="container">
	<div class="row" data-ng-app="msgp">
		{{if .Ws}}
		<div data-ng-controller="GraphPage">
				<div data-ng-repeat="device in devices" style="width: 100%">
					<h2>{{"{{device.name}}"}}</h2>
					<div style="width: 100%"
						data-ng-repeat="sensor in device.sensors"
						data-sensor-graph=""
						data-title="sensor.name"
						data-max-age-ms="120 * 1000"
						data-assume-missing-after-ms="3 * 1000"
						data-api="sensor.graph">
					</div>
				</div>
			</div>

			<script>
				angular.module("msgp").value("wsurl", {{.Ws}});
			</script>
		{{else}}
			<form action="/" method="POST">
				<p>
					<label for="user" {{alertIfMissing "user" .Missing}}>Display user</label>
					<input type="text" name="user" length="20" />
				</p>
				<input type="submit" value="Submit" />
			</form>
		{{end}}
	</div>
</div>
{{template "tail"}}
{{end}}
